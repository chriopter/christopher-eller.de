{{ define "main" }}
<div class="places-layout">
    <!-- Left Side: Content -->
    <div class="places-content">
        <!-- Navigation -->
        <nav class="places-nav">
            <a href="/places/" class="back-link">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M19 12H5"></path>
                    <path d="M12 19l-7-7 7-7"></path>
                </svg>
                Back to Places
            </a>
        </nav>

        <!-- Place Content -->
        <article class="place-article">
            <header class="place-header">
                <h1>{{ .Title }}</h1>
                {{ with .Description }}<p class="place-description">{{ . }}</p>{{ end }}
            </header>

            <!-- Tags -->
            {{ with .Params.tags }}
            <div class="place-tags">
                {{ range . }}<span class="tag">{{ . }}</span>{{ end }}
            </div>
            {{ end }}

            <!-- Website Link -->
            {{ with .Params.urls }}
            <div class="place-links">
                <a href="{{ . }}" class="website-link" target="_blank" rel="noopener noreferrer">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="12" cy="12" r="10"></circle>
                        <line x1="2" y1="12" x2="22" y2="12"></line>
                        <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path>
                    </svg>
                    Visit Website
                </a>
            </div>
            {{ end }}

            <!-- Main Content -->
            <div class="place-body">
                {{ .Content }}
            </div>

            <!-- Images -->
            {{ with .Resources.ByType "image" }}
            <div class="place-images">
                {{ range . }}
                <img src="{{ .RelPermalink }}" alt="{{ .Name }}" loading="lazy">
                {{ end }}
            </div>
            {{ end }}
        </article>
    </div>

    <!-- Right Side: Map -->
    <div class="places-map-container">
        <div id="places-map" 
             class="map" 
             data-lat="{{ .Params.lat }}" 
             data-lng="{{ .Params.lng }}" 
             data-title="{{ .Title }}">
        </div>
    </div>
</div>

<!-- Load CSS -->
<link rel="stylesheet" href="/places/node_modules/leaflet/dist/leaflet.css">
<link rel="stylesheet" href="/places/css/main.css">

<!-- Load JavaScript -->
<script src="/places/node_modules/leaflet/dist/leaflet.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
    const mapElement = document.getElementById('places-map');
    const lat = parseFloat(mapElement.dataset.lat);
    const lng = parseFloat(mapElement.dataset.lng);
    const title = mapElement.dataset.title;
    
    const map = L.map('places-map').setView([lat, lng], 13);
    
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: 'Â© OpenStreetMap contributors'
    }).addTo(map);
    
    L.marker([lat, lng])
        .bindPopup(title)
        .addTo(map);
});
</script>
{{ end }}
